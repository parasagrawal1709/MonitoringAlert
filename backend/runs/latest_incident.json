{
  "incident": {
    "type": "Backend URL Unhealthy",
    "details": "GET https://sre-agent-backend.onrender.com/health failed or returned non-200. Details: {'ok': False, 'status_code': None, 'details': \"Unreachable: HTTPSConnectionPool(host='sre-agent-backend.onrender.com', port=443): Max retries exceeded with url: /health (Caused by SSLError(SSLCertVerificationError(1, '[SSL: CERTIFICATE_VERIFY_FAILED] certificate verify failed: unable to get local issuer certificate (_ssl.c:1006)')))\"}",
    "severity": "HIGH"
  },
  "status": "blocked",
  "evidence": {
    "backend_health_before": {
      "ok": false,
      "status_code": null,
      "details": "Unreachable: HTTPSConnectionPool(host='sre-agent-backend.onrender.com', port=443): Max retries exceeded with url: /health (Caused by SSLError(SSLCertVerificationError(1, '[SSL: CERTIFICATE_VERIFY_FAILED] certificate verify failed: unable to get local issuer certificate (_ssl.c:1006)')))"
    },
    "backend_health_after": {
      "ok": false,
      "status_code": null,
      "details": "Unreachable: HTTPSConnectionPool(host='sre-agent-backend.onrender.com', port=443): Max retries exceeded with url: /health (Caused by SSLError(SSLCertVerificationError(1, '[SSL: CERTIFICATE_VERIFY_FAILED] certificate verify failed: unable to get local issuer certificate (_ssl.c:1006)')))"
    }
  },
  "attempts": [
    {
      "action": "backend_self_heal",
      "ok": false,
      "details": "Failed to start backend: HTTPSConnectionPool(host='sre-agent-backend.onrender.com', port=443): Max retries exceeded with url: /health (Caused by SSLError(SSLCertVerificationError(1, '[SSL: CERTIFICATE_VERIFY_FAILED] certificate verify failed: unable to get local issuer certificate (_ssl.c:1006)')))"
    }
  ],
  "next_steps": [
    "Confirm backend_app.py exists and uvicorn is installed.",
    "Try starting manually: py -3.11 -m uvicorn backend_app:app --host 0.0.0.0 --port 8001",
    "Check if another process is already using the port."
  ],
  "vulnerability": {
    "cwe": "CWE-693",
    "title": "Protection Mechanism Failure",
    "description": "Service health endpoint is down/unreachable; self-heal may require restarting service/process.",
    "example_cves": [
      "nan"
    ],
    "keywords": [],
    "source": "CWE_Knowledge_Base.xlsx::CWE_Mapping"
  },
  "email_subject": "[SRE-AI] Backend URL Unhealthy | windows-demo-host | BLOCKED",
  "email_body_html": "\n    <div style=\"font-family:Segoe UI, Arial, sans-serif; color:#111827; line-height:1.45; max-width:760px;\">\n      <div style=\"padding:16px 18px; border:1px solid #e5e7eb; border-radius:14px; background:#ffffff;\">\n        <div style=\"display:flex; justify-content:space-between; gap:12px; align-items:flex-start; flex-wrap:wrap;\">\n          <div>\n            <div style=\"font-size:16px; font-weight:800; margin-bottom:2px;\">\n              SRE AI Agent Report\n            </div>\n            <div style=\"font-size:13px; color:#6b7280;\">\n              Host: <strong style=\"color:#111827;\">windows-demo-host</strong>\n            </div>\n          </div>\n          <div style=\"display:flex; gap:8px; align-items:center;\">\n            \n    <span style=\"\n        display:inline-block;\n        padding:2px 10px;\n        border-radius:999px;\n        font-size:12px;\n        color:#842029;\n        background:#f8d7da;\n        border:1px solid #f5c2c7;\n        line-height:18px;\n        vertical-align:middle;\n    \">HIGH</span>\n    \n            \n    <span style=\"\n        display:inline-block;\n        padding:2px 10px;\n        border-radius:999px;\n        font-size:12px;\n        color:#842029;\n        background:#f8d7da;\n        border:1px solid #f5c2c7;\n        line-height:18px;\n        vertical-align:middle;\n    \">BLOCKED</span>\n    \n          </div>\n        </div>\n\n        <hr style=\"border:none; border-top:1px solid #e5e7eb; margin:14px 0;\" />\n\n        <table style=\"border-collapse:collapse; width:100%; font-size:13px;\">\n          \n    <tr>\n      <td style=\"padding:10px 12px; border:1px solid #e5e7eb; width:180px; color:#111827; background:#f9fafb;\">\n        <strong>Incident Type</strong>\n      </td>\n      <td style=\"padding:10px 12px; border:1px solid #e5e7eb; color:#111827;\">\n        <strong>Backend URL Unhealthy</strong>\n      </td>\n    </tr>\n    \n          \n    <tr>\n      <td style=\"padding:10px 12px; border:1px solid #e5e7eb; width:180px; color:#111827; background:#f9fafb;\">\n        <strong>Severity</strong>\n      </td>\n      <td style=\"padding:10px 12px; border:1px solid #e5e7eb; color:#111827;\">\n        \n    <span style=\"\n        display:inline-block;\n        padding:2px 10px;\n        border-radius:999px;\n        font-size:12px;\n        color:#842029;\n        background:#f8d7da;\n        border:1px solid #f5c2c7;\n        line-height:18px;\n        vertical-align:middle;\n    \">HIGH</span>\n    \n      </td>\n    </tr>\n    \n          \n    <tr>\n      <td style=\"padding:10px 12px; border:1px solid #e5e7eb; width:180px; color:#111827; background:#f9fafb;\">\n        <strong>Details</strong>\n      </td>\n      <td style=\"padding:10px 12px; border:1px solid #e5e7eb; color:#111827;\">\n        <div style='white-space:pre-wrap; color:#374151;'>GET https://sre-agent-backend.onrender.com/health failed or returned non-200. Details: {&#39;ok&#39;: False, &#39;status_code&#39;: None, &#39;details&#39;: &quot;Unreachable: HTTPSConnectionPool(host=&#39;sre-agent-backend.onrender.com&#39;, port=443): Max retries exceeded with url: /health (Caused by SSLError(SSLCertVerificationError(1, &#39;[SSL: CERTIFICATE_VERIFY_FAILED] certificate verify failed: unable to get local issuer certificate (_ssl.c:1006)&#39;)))&quot;}</div>\n      </td>\n    </tr>\n    \n        </table>\n\n        <div style=\"margin-top:16px; padding:14px; border:1px solid #e5e7eb; border-radius:12px; background:#f9fafb;\">\n          <div style=\"font-size:13px; font-weight:700; margin-bottom:8px;\">\n            Remediation Attempts\n          </div>\n          <ul style='margin:0; padding-left:18px;'><li style='margin:6px 0;'>{&#39;action&#39;: &#39;backend_self_heal&#39;, &#39;ok&#39;: False, &#39;details&#39;: &quot;Failed to start backend: HTTPSConnectionPool(host=&#39;sre-agent-backend.onrender.com&#39;, port=443): Max retries exceeded with url: /health (Caused by SSLError(SSLCertVerificationError(1, &#39;[SSL: CERTIFICATE_VERIFY_FAILED] certificate verify failed: unable to get local issuer certificate (_ssl.c:1006)&#39;)))&quot;}</li></ul>\n        </div>\n\n        <div style=\"margin-top:16px; padding:14px; border:1px solid #e5e7eb; border-radius:12px; background:#f9fafb;\">\n          <div style=\"font-size:13px; font-weight:700; margin-bottom:8px;\">\n            Recommended Next Steps\n          </div>\n          <ul style='margin:0; padding-left:18px;'><li style='margin:6px 0;'>Confirm backend_app.py exists and uvicorn is installed.</li><li style='margin:6px 0;'>Try starting manually: py -3.11 -m uvicorn backend_app:app --host 0.0.0.0 --port 8001</li><li style='margin:6px 0;'>Check if another process is already using the port.</li></ul>\n        </div>\n\n        \n    <div style=\"margin-top:16px; padding:14px; border:1px solid #e5e7eb; border-radius:12px; background:#ffffff;\">\n      <div style=\"display:flex; align-items:center; justify-content:space-between; gap:10px; margin-bottom:10px;\">\n        <div style=\"font-size:14px; font-weight:700; color:#111827;\">\n          Vulnerability Mapping (CWE)\n        </div>\n        \n    <span style=\"\n        display:inline-block;\n        padding:2px 10px;\n        border-radius:999px;\n        font-size:12px;\n        color:#41464b;\n        background:#e2e3e5;\n        border:1px solid #d3d6d8;\n        line-height:18px;\n        vertical-align:middle;\n    \">CWE-693</span>\n    \n      </div>\n\n      <table style=\"border-collapse:collapse; width:100%; font-size:13px;\">\n        \n    <tr>\n      <td style=\"padding:10px 12px; border:1px solid #e5e7eb; width:180px; color:#111827; background:#f9fafb;\">\n        <strong>CWE Title</strong>\n      </td>\n      <td style=\"padding:10px 12px; border:1px solid #e5e7eb; color:#111827;\">\n        <span style='font-weight:600;'>Protection Mechanism Failure</span>\n      </td>\n    </tr>\n    \n        \n    <tr>\n      <td style=\"padding:10px 12px; border:1px solid #e5e7eb; width:180px; color:#111827; background:#f9fafb;\">\n        <strong>Meaning</strong>\n      </td>\n      <td style=\"padding:10px 12px; border:1px solid #e5e7eb; color:#111827;\">\n        <span style='color:#374151;'>Service health endpoint is down/unreachable; self-heal may require restarting service/process.</span>\n      </td>\n    </tr>\n    \n        \n    <tr>\n      <td style=\"padding:10px 12px; border:1px solid #e5e7eb; width:180px; color:#111827; background:#f9fafb;\">\n        <strong>Example CVEs</strong>\n      </td>\n      <td style=\"padding:10px 12px; border:1px solid #e5e7eb; color:#111827;\">\n        <div style='display:flex; flex-wrap:wrap; gap:6px;'>\n    <span style=\"\n        display:inline-block;\n        padding:2px 10px;\n        border-radius:999px;\n        font-size:12px;\n        color:#084298;\n        background:#cfe2ff;\n        border:1px solid #b6d4fe;\n        line-height:18px;\n        vertical-align:middle;\n    \">nan</span>\n    </div>\n      </td>\n    </tr>\n    \n      </table>\n\n      <p style=\"margin:10px 0 0; font-size:12px; color:#6b7280;\">\n        Note: CWE mapping is used for standard classification. CVEs shown are examples/references (not necessarily present on this host).\n      </p>\n    </div>\n    \n\n        <hr style=\"border:none; border-top:1px solid #e5e7eb; margin:16px 0 10px;\" />\n        <div style=\"font-size:12px; color:#6b7280;\">\n          This message was generated by the demo SRE AI agent (policy-safe actions only).\n        </div>\n      </div>\n    </div>\n    ",
  "timestamp": "2026-01-23T08:15:19.767052Z"
}